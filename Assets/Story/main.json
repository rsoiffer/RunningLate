{"inkVersion":20,"root":[["\n","\n",{"->":"prologue"},["done",{"#f":5,"#n":"g-0"}],null],"done",{"prologue":[[{"#":"DIALOGUE"},"^INSERT PROLOGUE TEXT OF SOME SORT.","\n","ev","str","^Continue...","/str","/ev",{"*":".^.c-0","flg":20},{"c-0":["\n",{"->":"main_loop"},{"#f":5}]}],{"#f":1}],"main_loop":[[{"#":"MENU"},"^MAIN LOOP","\n","^Can clean: ","ev",{"f()":"canCleanBlood"},"out","/ev","\n","^Has incriminating evidence: ","ev",{"f()":"hasIncriminatingEvidence"},"out","/ev","\n","^Pick an option:","\n","ev","str","^INTERACT(\"mechanic\")","/str","str","^mechanic","/str",{"x()":"nearby","exArgs":1},"/ev",{"*":".^.c-0","flg":5},"ev","str","^INTERACT(\"fireplace\")","/str","str","^fireplace","/str",{"x()":"nearby","exArgs":1},"/ev",{"*":".^.c-1","flg":5},{"c-0":["\n",{"->":"mechanic"},{"#f":5}],"c-1":["\n",{"->":"fireplace"},{"->":".^.^.^"},"end",{"#f":5}]}],{"#f":1}],"canCleanBlood":["ev",{"VAR?":"can_clean"},{"VAR?":"inventory"},"L^","LIST_COUNT",0,">","/ev","~ret","\n",{"#f":1}],"cleanBlood":["ev",{"f()":"canCleanBlood"},"/ev",[{"->":".^.b","c":true},{"b":["\n","ev",{"VAR?":"bloody"},{"VAR?":"can_clean"},{"VAR?":"inventory"},"L^","LIST_MIN","+",{"VAR=":"bloody","re":true},"/ev","\n","ev",true,"/ev","~ret",{"->":".^.^.^.5"},null]}],[{"->":".^.b"},{"b":["\n","ev",false,"/ev","~ret",{"->":".^.^.^.5"},null]}],"nop","\n",{"#f":1}],"hasIncriminatingEvidence":["ev",{"VAR?":"inventory"},{"VAR?":"incriminating"},{"VAR?":"bloody"},"+","L^","LIST_COUNT",0,">","/ev","~ret","\n",{"#f":1}],"flammableItems":["ev",{"VAR?":"inventory"},{"VAR?":"flammable"},"L^","/ev","~ret",{"#f":1}],"burnEvidence":[{"temp=":"item"},"ev",{"VAR?":"inventory"},{"VAR?":"item"},"-",{"VAR=":"inventory","re":true},"/ev","ev",{"VAR?":"items_in_fireplace"},{"VAR?":"item"},"+",{"VAR=":"items_in_fireplace","re":true},"/ev","ev","str","^fireplace","/str",60,{"x()":"addTime","exArgs":2},"pop","/ev","\n",{"#f":1}],"nearby":[{"temp=":"obj_id"},"ev",true,"/ev","~ret",{"#f":1}],"addTime":[{"temp=":"seconds"},{"temp=":"timer_id"},"ev","void","/ev","~ret",{"#f":1}],"mechanic":[{"#":"DIALOGUE"},["ev",{"VAR?":"mechanic_state"},{"VAR?":"idle"},"?","/ev",{"->":".^.b","c":true},{"b":["\n",{"->":".^.^.^.idle_dialogue"},{"->":".^.^.^.4"},null]}],["ev",{"VAR?":"mechanic_state"},{"VAR?":"distracted"},"?","/ev",{"->":".^.b","c":true},{"b":["\n",{"->":".^.^.^.distracted_dialogue"},{"->":".^.^.^.4"},null]}],[{"->":".^.b"},{"b":["\n",{"->":".^.^.^.other"},{"->":".^.^.^.4"},null]}],"nop","\n",{"idle_dialogue":[["^Mechanic: What are you up to?","\n",["ev",{"^->":"mechanic.idle_dialogue.0.2.$r1"},{"temp=":"$r"},"str",{"->":".^.s"},[{"#n":"$r1"}],"/str","/ev",{"*":".^.^.c-0","flg":2},{"s":["^Nothing suspicious.",{"->":"$r","var":true},null]}],["ev",{"^->":"mechanic.idle_dialogue.0.3.$r1"},{"temp=":"$r"},"str",{"->":".^.s"},[{"#n":"$r1"}],"/str","/ev",{"*":".^.^.c-1","flg":2},{"s":["^Never mind.",{"->":"$r","var":true},null]}],["ev",{"^->":"mechanic.idle_dialogue.0.4.$r1"},{"temp=":"$r"},"str",{"->":".^.s"},[{"#n":"$r1"}],"/str",{"VAR?":"inventory"},{"VAR?":"wireless_schematics"},"?","/ev",{"*":".^.^.c-2","flg":3},{"s":["^Have you heard about Marconi's wireless telegraph?",{"->":"$r","var":true},null]}],{"c-0":["ev",{"^->":"mechanic.idle_dialogue.0.c-0.$r2"},"/ev",{"temp=":"$r"},{"->":".^.^.2.s"},[{"#n":"$r2"}],"\n","^Mechanic: That's an odd thing to say.","\n","ev",{"list":{"states.suspicious":2}},"/ev",{"VAR=":"mechanic_state","re":true},{"->":".^.^.g-0"},{"#f":5}],"c-1":["ev",{"^->":"mechanic.idle_dialogue.0.c-1.$r2"},"/ev",{"temp=":"$r"},{"->":".^.^.3.s"},[{"#n":"$r2"}],"\n",{"->":".^.^.g-0"},{"#f":5}],"c-2":["ev",{"^->":"mechanic.idle_dialogue.0.c-2.$r2"},"/ev",{"temp=":"$r"},{"->":".^.^.4.s"},[{"#n":"$r2"}],"\n","^Mechanic: No, what's that?","\n",[["ev",{"^->":"mechanic.idle_dialogue.0.c-2.9.0.$r1"},{"temp=":"$r"},"str",{"->":".^.s"},[{"#n":"$r1"}],"/str","/ev",{"*":".^.^.c-0","flg":2},{"s":["^Never mind, I bet you wouldn't understand anyways.",{"->":"$r","var":true},null]}],["ev",{"^->":"mechanic.idle_dialogue.0.c-2.9.1.$r1"},{"temp=":"$r"},"str",{"->":".^.s"},[{"#n":"$r1"}],"/str","/ev",{"*":".^.^.c-1","flg":2},{"s":["^It's a telegraph that works without a wire.  Uses invisible light or something.",{"->":"$r","var":true},null]}],{"c-0":["ev",{"^->":"mechanic.idle_dialogue.0.c-2.9.c-0.$r2"},"/ev",{"temp=":"$r"},{"->":".^.^.0.s"},[{"#n":"$r2"}],"\n","^Mechanic: What do you take me for, some sort of rube?","\n","^Mechanic: I'll have you know I'm a highly educated guy.","\n",[["ev",{"^->":"mechanic.idle_dialogue.0.c-2.9.c-0.11.0.$r1"},{"temp=":"$r"},"str",{"->":".^.s"},[{"#n":"$r1"}],"/str","/ev",{"*":".^.^.c-0","flg":2},{"s":["^Well, then, what do you make of these schematics?",{"->":"$r","var":true},null]}],{"c-0":["ev",{"^->":"mechanic.idle_dialogue.0.c-2.9.c-0.11.c-0.$r2"},"/ev",{"temp=":"$r"},{"->":".^.^.0.s"},[{"#n":"$r2"}],"\n","^Mechanic: Hm, give me a second to take a look at that.","\n","ev",{"list":{"states.distracted":5}},"/ev",{"VAR=":"mechanic_state","re":true},{"->":".^.^.^.^.^.^.g-0"},{"#f":5}]}],{"#f":5}],"c-1":["ev",{"^->":"mechanic.idle_dialogue.0.c-2.9.c-1.$r2"},"/ev",{"temp=":"$r"},{"->":".^.^.1.s"},[{"#n":"$r2"}],"\n","^Mechanic: Sounds like nonsense.","\n",{"->":".^.^.^.^.g-0"},{"#f":5}]}],{"#f":5}],"g-0":[{"->":"main_loop"},{"#f":5}]}],{"#f":1}],"distracted_dialogue":["^Mechanic: Give me a sec, these schematics are fascinating.","\n",{"->":"main_loop"},{"#f":1}],"other":["^Mechanic: I've got my eye on you, scoundrel.","\n",{"->":"main_loop"},{"#f":1}],"#f":1}],"fireplace":[[{"#":"INTERACT"},"^The fireplace is ","ev",{"VAR?":"fireplace_state"},{"VAR?":"burning"},"?","/ev",[{"->":".^.b","c":true},{"b":["^crackling merrily",{"->":".^.^.^.9"},null]}],[{"->":".^.b"},{"b":["^cold and dark",{"->":".^.^.^.9"},null]}],"nop","^.","\n","thread",{"->":".^.^.toggle_fire_state"},"ev",{"f()":"flammableItems"},"/ev","thread",{"->":".^.^.burn_options"},["ev",{"^->":"fireplace.0.19.$r1"},{"temp=":"$r"},"str",{"->":".^.s"},[{"#n":"$r1"}],"/str","/ev",{"*":".^.^.c-0","flg":2},{"s":["^Exit ",{"->":"$r","var":true},null]}],{"c-0":["ev",{"^->":"fireplace.0.c-0.$r2"},"/ev",{"temp=":"$r"},{"->":".^.^.19.s"},[{"#n":"$r2"}],{"->":"main_loop"},"\n","done",{"#f":5}]}],{"toggle_fire_state":[["ev","str","^Put out the fire.","/str",{"VAR?":"fireplace_state"},{"VAR?":"burning"},"?","/ev",{"*":".^.c-0","flg":5},"ev","str","^Light the fire.","/str",{"VAR?":"fireplace_state"},{"VAR?":"cold"},"?","/ev",{"*":".^.c-1","flg":5},{"c-0":["\n","ev",{"VAR?":"cold"},"/ev",{"VAR=":"fireplace_state","re":true},{"->":".^.^.^.^"},{"#f":5}],"c-1":["\n","ev",{"VAR?":"burning"},"/ev",{"VAR=":"fireplace_state","re":true},{"->":".^.^.^.^"},"done",{"#f":5}]}],{"#f":1}],"burn_options":[{"temp=":"flammables"},"ev",{"VAR?":"fireplace_state"},{"VAR?":"cold"},"?","/ev",[{"->":".^.b","c":true},{"b":["^ ","done",{"->":".^.^.^.7"},null]}],"nop","\n","ev",{"VAR?":"flammables"},"LIST_MIN","/ev",[{"->":".^.b","c":true},{"b":["\n","ev",{"VAR?":"flammables"},"LIST_MIN","/ev",{"temp=":"item_to_burn"},"\n","ev",{"VAR?":"flammables"},{"VAR?":"item_to_burn"},"-","/ev","thread",{"->":".^.^.^"},"ev","str","^Burn ","ev",{"VAR?":"item_to_burn"},"out","/ev","/str","/ev",{"*":".^.c-0","flg":4},{"->":".^.^.^.15"},{"c-0":["\n","ev",{"VAR?":"item_to_burn"},"/ev",{"->":"fireplace.burn_item"},"done",{"#f":5}]}]}],[{"->":".^.b"},{"b":["\n","done",{"->":".^.^.^.15"},null]}],"nop","\n",{"#f":1}],"burn_item":[{"temp=":"item_to_burn"},"^The fire crackles as you toss in the ","ev",{"VAR?":"item_to_burn"},"out","/ev","^.","\n","ev",{"VAR?":"item_to_burn"},{"f()":"burnEvidence"},"pop","/ev","\n",{"->":".^.^"},{"#f":1}],"#f":1}],"global decl":["ev",{"list":{},"origins":["items"]},{"VAR=":"items"},{"list":{"items.knife":1,"items.letter":2}},{"VAR=":"incriminating"},{"list":{"items.mop":4,"items.cloth":5,"items.handkerchief":6}},{"VAR=":"can_clean"},{"list":{"items.letter":2,"items.wireless_schematics":3,"items.mop":4,"items.cloth":5}},{"VAR=":"flammable"},{"list":{"items.knife":1,"items.letter":2,"items.wireless_schematics":3,"items.handkerchief":6}},{"VAR=":"inventory"},{"list":{}},{"VAR=":"bloody"},true,{"VAR=":"bloody_hands"},false,{"VAR=":"drunk"},{"list":{},"origins":["states"]},{"VAR=":"states"},{"list":{"states.idle":1}},{"VAR=":"conductor_state"},{"list":{"states.idle":1}},{"VAR=":"mechanic_state"},{"list":{"fire_states.burning":1}},{"VAR=":"fire_states"},{"list":{"fire_states.burning":1}},{"VAR=":"fireplace_state"},{"list":{}},{"VAR=":"items_in_fireplace"},"/ev","end",null],"#f":1}],"listDefs":{"items":{"knife":1,"letter":2,"wireless_schematics":3,"mop":4,"cloth":5,"handkerchief":6},"states":{"idle":1,"suspicious":2,"panicked":3,"seek_target":4,"distracted":5},"fire_states":{"burning":1,"cold":2}}}